/*
class Node {
public:
    int data;
    Node* next;
    Node* bottom;

    Node(int x) {
        data = x;
        next = NULL;
        bottom = NULL;
    }
};
*/

class Solution {
  public:
    Node* mergeLL(Node* down, Node* right) {
        if(down == NULL) return right;
        if(right == NULL) return down;
        
        Node* dummy = new Node(-1);
        Node* temp = dummy;
        
        while(down != NULL && right != NULL) {
            if(down -> data < right -> data) {
                temp -> bottom = down;
                down = down -> bottom;
            }
            else {
                temp -> bottom = right;
                right = right -> bottom;
            }
            
            temp = temp -> bottom;
        }
        
        while(down != NULL) {
            temp -> bottom = down;
            temp = temp -> bottom;
            down = down -> bottom;
        }
        
        while(right != NULL) {
            temp -> bottom = right;
            temp = temp -> bottom;
            right = right -> bottom;
        }
        
        Node* head = dummy -> bottom;
        dummy -> bottom = NULL;
        delete(dummy);
        
        return head;
    }
    
    Node *flatten(Node *root) {
        // code here
        if(root == NULL || root -> next == NULL) {
            return root;
        }
        
        Node* downLL  = root; // first bottom LL
        Node* rightLL = flatten(root -> next); // recursively creating a sorted bottom LL
        
        downLL -> next = NULL; // disconnecting the bottom with right
        
        Node* head = mergeLL(downLL, rightLL);
        
        return head;
    }
};
